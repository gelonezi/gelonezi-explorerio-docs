# Docker Compose Installation

> ⚠️ **Warning:** This file was generated by AI and has not been reviewed yet.

This guide will help you set up ExplorerIO using Docker Compose, which is the recommended approach for development and small-scale deployments.

## Prerequisites

Before you begin, ensure you have the following installed on your system:

- **Docker**: Version 20.10 or higher
- **Docker Compose**: Version 2.0 or higher  
- **Git**: For cloning the repository
- **Minimum System Requirements**:
  - 4GB RAM
  - 2 CPU cores
  - 10GB available disk space

## Quick Start

### 1. Clone the Repository

```bash
git clone https://github.com/gelonezi/explorerio.git
cd explorerio
```

### 2. Configuration Setup

Copy the example environment file and customize it for your environment:

```bash
cp .env.example .env
```

Edit the `.env` file with your preferred settings:

```bash
# Database Configuration
POSTGRES_USER=explorerio
POSTGRES_PASSWORD=your_secure_password
POSTGRES_DB=explorerio_db

# Redis Configuration  
REDIS_PASSWORD=your_redis_password

# Application Configuration
APP_SECRET_KEY=your_secret_key_here
APP_ENV=development
APP_DEBUG=true

# External Services
ELASTICSEARCH_PASSWORD=your_elasticsearch_password
```

### 3. Start the Services

Launch all services with a single command:

```bash
docker-compose up -d
```

This will start the following services:
- **Web Application**: Main ExplorerIO interface
- **API Server**: Backend REST API
- **PostgreSQL**: Primary database
- **Redis**: Cache and session storage
- **Elasticsearch**: Search engine
- **Nginx**: Reverse proxy and load balancer

### 4. Verify Installation

Check that all services are running:

```bash
docker-compose ps
```

You should see all services with "Up" status. Access the application at:
- **Web Interface**: http://localhost:8080
- **API Documentation**: http://localhost:8080/api/docs

## Service Configuration

### Database Setup

The PostgreSQL database will be automatically initialized with the required schema. For manual database operations:

```bash
# Access the database container
docker-compose exec postgres psql -U explorerio -d explorerio_db

# Run database migrations
docker-compose exec api npm run migrate

# Seed initial data
docker-compose exec api npm run seed
```

### Search Engine Setup

Elasticsearch will start automatically, but you may want to customize the configuration:

```yaml
# docker-compose.override.yml
services:
  elasticsearch:
    environment:
      - "ES_JAVA_OPTS=-Xms2g -Xmx2g"  # Adjust memory allocation
      - discovery.type=single-node
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data
```

### Cache Configuration

Redis is configured for both session storage and application caching:

```bash
# Monitor Redis performance
docker-compose exec redis redis-cli monitor

# Check cache statistics
docker-compose exec redis redis-cli info stats
```

## Development Mode

For development, you can run services with hot reloading:

```bash
# Start in development mode
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d

# View logs for a specific service
docker-compose logs -f api

# Restart a specific service
docker-compose restart api
```

## Production Considerations

### Security Hardening

For production deployments, implement these security measures:

1. **Change Default Passwords**: Update all default passwords in the `.env` file
2. **Use SSL/TLS**: Configure HTTPS with proper certificates
3. **Network Security**: Restrict access to internal services
4. **Regular Updates**: Keep Docker images and dependencies updated

### Performance Optimization

```yaml
# docker-compose.prod.yml
services:
  api:
    deploy:
      replicas: 3
      resources:
        limits:
          memory: 1G
          cpus: '0.5'
  
  postgres:
    command: postgres -c shared_preload_libraries=pg_stat_statements
    environment:
      - POSTGRES_SHARED_PRELOAD_LIBRARIES=pg_stat_statements
```

### Backup Configuration

Set up automated backups for persistent data:

```bash
# Database backup script
#!/bin/bash
docker-compose exec -T postgres pg_dump -U explorerio explorerio_db | \
  gzip > backup_$(date +%Y%m%d_%H%M%S).sql.gz

# Elasticsearch backup
docker-compose exec elasticsearch curl -X PUT "localhost:9200/_snapshot/backup_repo" \
  -H 'Content-Type: application/json' -d'{"type": "fs", "settings": {"location": "/backups"}}'
```

## Troubleshooting

### Common Issues

#### Port Conflicts
If you encounter port conflicts, modify the ports in `docker-compose.yml`:

```yaml
services:
  nginx:
    ports:
      - "8081:80"  # Change from 8080 to 8081
```

#### Memory Issues
If services are running out of memory:

```bash
# Increase Docker memory limit
# For Docker Desktop: Settings > Resources > Memory

# Monitor container memory usage
docker stats
```

#### Database Connection Issues
```bash
# Check database logs
docker-compose logs postgres

# Test database connectivity
docker-compose exec api npm run db:test-connection
```

### Log Management

```bash
# View all service logs
docker-compose logs

# Follow logs for specific service
docker-compose logs -f api

# Limit log output
docker-compose logs --tail=100 api
```

### Health Checks

Monitor service health:

```bash
# Check service health status
curl http://localhost:8080/health

# Individual service health checks
curl http://localhost:8080/api/health
curl http://localhost:9200/_cluster/health
```

## Updating ExplorerIO

To update to the latest version:

```bash
# Pull latest changes
git pull origin main

# Rebuild and restart services
docker-compose down
docker-compose pull
docker-compose up -d

# Run any pending migrations
docker-compose exec api npm run migrate
```

## Cleanup

To completely remove ExplorerIO and all data:

```bash
# Stop and remove containers
docker-compose down

# Remove volumes (WARNING: This deletes all data)
docker-compose down -v

# Remove images
docker-compose down --rmi all
```

## Next Steps

- Configure [Environment Variables](env-vars.md) for your specific setup
- Explore [Features](../features/authentication.md) available in ExplorerIO
- Learn about [API Integration](../api/overview.md)
