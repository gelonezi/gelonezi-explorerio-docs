# API Endpoints

> ⚠️ **Warning:** This file was generated by AI and has not been reviewed yet.

This document provides detailed information about all available API endpoints in ExplorerIO, including request/response examples and parameter descriptions.

## Authentication Endpoints

### Login

**POST** `/api/v1/auth/login`

Authenticate a user and receive access tokens.

**Request Body**:
```json
{
  "username": "user@example.com",
  "password": "password123",
  "remember_me": false
}
```

**Response**:
```json
{
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "dGhpc0lzQVJlZnJlc2hUb2tlbg...",
    "token_type": "Bearer",
    "expires_in": 3600,
    "user": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "email": "user@example.com",
      "name": "John Doe",
      "roles": ["user"]
    }
  }
}
```

### Logout

**POST** `/api/v1/auth/logout`

Invalidate the current session token.

**Headers**: `Authorization: Bearer <token>`

**Response**:
```json
{
  "data": {
    "message": "Successfully logged out"
  }
}
```

### Refresh Token

**POST** `/api/v1/auth/refresh`

Refresh an expired access token.

**Request Body**:
```json
{
  "refresh_token": "dGhpc0lzQVJlZnJlc2hUb2tlbg..."
}
```

**Response**:
```json
{
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "Bearer",
    "expires_in": 3600
  }
}
```

## User Management Endpoints

### Get Current User

**GET** `/api/v1/users/me`

Retrieve the current user's profile information.

**Headers**: `Authorization: Bearer <token>`

**Response**:
```json
{
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "name": "John Doe",
    "avatar_url": "https://example.com/avatar.jpg",
    "roles": ["user", "analyst"],
    "permissions": ["data:read", "reports:create"],
    "created_at": "2024-01-15T10:30:00Z",
    "last_login": "2024-01-15T14:45:00Z",
    "preferences": {
      "theme": "dark",
      "timezone": "UTC",
      "language": "en"
    }
  }
}
```

### Update Current User

**PUT** `/api/v1/users/me`

Update the current user's profile.

**Headers**: `Authorization: Bearer <token>`

**Request Body**:
```json
{
  "name": "John Smith",
  "preferences": {
    "theme": "light",
    "timezone": "America/New_York"
  }
}
```

**Response**:
```json
{
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "name": "John Smith",
    "preferences": {
      "theme": "light",
      "timezone": "America/New_York",
      "language": "en"
    },
    "updated_at": "2024-01-15T15:00:00Z"
  }
}
```

### List Users (Admin Only)

**GET** `/api/v1/users`

Retrieve a list of all users in the system.

**Headers**: `Authorization: Bearer <token>`

**Query Parameters**:
- `limit` (integer): Number of results per page (default: 20, max: 100)
- `offset` (integer): Number of results to skip
- `search` (string): Search term for filtering users
- `role` (string): Filter by user role
- `status` (string): Filter by user status (active, inactive, suspended)
- `sort` (string): Sort field and direction (e.g., "created_at:desc")

**Response**:
```json
{
  "data": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "email": "user1@example.com",
      "name": "John Doe",
      "roles": ["user"],
      "status": "active",
      "created_at": "2024-01-15T10:30:00Z",
      "last_login": "2024-01-15T14:45:00Z"
    }
  ],
  "pagination": {
    "limit": 20,
    "offset": 0,
    "total": 150,
    "has_more": true
  }
}
```

## Data Source Endpoints

### List Data Sources

**GET** `/api/v1/data/sources`

Retrieve all configured data sources.

**Headers**: `Authorization: Bearer <token>`

**Query Parameters**:
- `limit` (integer): Results per page
- `offset` (integer): Results to skip
- `type` (string): Filter by source type
- `status` (string): Filter by connection status

**Response**:
```json
{
  "data": [
    {
      "id": "ds_123456789",
      "name": "Main Database",
      "type": "postgresql",
      "status": "connected",
      "description": "Primary PostgreSQL database",
      "connection_info": {
        "host": "db.example.com",
        "database": "analytics"
      },
      "last_sync": "2024-01-15T14:30:00Z",
      "created_at": "2024-01-01T10:00:00Z",
      "updated_at": "2024-01-15T14:30:00Z"
    }
  ]
}
```

### Create Data Source

**POST** `/api/v1/data/sources`

Create a new data source configuration.

**Headers**: `Authorization: Bearer <token>`

**Request Body**:
```json
{
  "name": "Customer Database",
  "type": "mysql",
  "description": "MySQL customer database",
  "connection": {
    "host": "mysql.example.com",
    "port": 3306,
    "database": "customers",
    "username": "readonly_user",
    "password": "secure_password"
  },
  "sync_settings": {
    "schedule": "0 */6 * * *",
    "batch_size": 1000,
    "enabled": true
  }
}
```

**Response**:
```json
{
  "data": {
    "id": "ds_987654321",
    "name": "Customer Database",
    "type": "mysql",
    "status": "pending",
    "created_at": "2024-01-15T15:00:00Z"
  }
}
```

### Test Data Source Connection

**POST** `/api/v1/data/sources/{id}/test`

Test the connection to a data source.

**Headers**: `Authorization: Bearer <token>`

**Response**:
```json
{
  "data": {
    "status": "success",
    "message": "Connection established successfully",
    "response_time_ms": 145,
    "details": {
      "server_version": "PostgreSQL 13.4",
      "available_tables": 25
    }
  }
}
```

### Sync Data Source

**POST** `/api/v1/data/sources/{id}/sync`

Trigger a manual synchronization of a data source.

**Headers**: `Authorization: Bearer <token>`

**Request Body**:
```json
{
  "type": "incremental",
  "force": false
}
```

**Response**:
```json
{
  "data": {
    "sync_id": "sync_abc123def456",
    "status": "started",
    "estimated_duration": "15 minutes",
    "started_at": "2024-01-15T15:10:00Z"
  }
}
```

## Search Endpoints

### Basic Search

**GET** `/api/v1/search`

Perform a basic search across all indexed data.

**Headers**: `Authorization: Bearer <token>`

**Query Parameters**:
- `q` (string, required): Search query
- `limit` (integer): Number of results (default: 20, max: 100)
- `offset` (integer): Results to skip
- `category` (string): Filter by category
- `sort` (string): Sort order (relevance, date, title)

**Example Request**:
```
GET /api/v1/search?q=analytics+report&limit=10&category=reports&sort=relevance
```

**Response**:
```json
{
  "data": [
    {
      "id": "doc_123456789",
      "title": "Monthly Analytics Report",
      "content": "This report provides insights into...",
      "category": "reports",
      "author": "john.doe@example.com",
      "created_at": "2024-01-10T09:00:00Z",
      "score": 0.95,
      "highlights": {
        "title": ["Monthly <em>Analytics</em> <em>Report</em>"],
        "content": ["This <em>report</em> provides insights..."]
      }
    }
  ],
  "pagination": {
    "limit": 10,
    "offset": 0,
    "total": 45,
    "has_more": true
  },
  "facets": {
    "category": [
      {"key": "reports", "count": 25},
      {"key": "dashboards", "count": 15},
      {"key": "data", "count": 5}
    ],
    "author": [
      {"key": "john.doe@example.com", "count": 12},
      {"key": "jane.smith@example.com", "count": 8}
    ]
  }
}
```

### Advanced Search

**POST** `/api/v1/search/advanced`

Perform an advanced search with complex filters and queries.

**Headers**: `Authorization: Bearer <token>`

**Request Body**:
```json
{
  "query": {
    "bool": {
      "must": [
        {
          "multi_match": {
            "query": "analytics dashboard",
            "fields": ["title^2", "content", "tags"]
          }
        }
      ],
      "filter": [
        {
          "range": {
            "created_at": {
              "gte": "2024-01-01",
              "lte": "2024-12-31"
            }
          }
        },
        {
          "terms": {
            "category": ["reports", "dashboards"]
          }
        }
      ]
    }
  },
  "sort": [
    {"_score": {"order": "desc"}},
    {"created_at": {"order": "desc"}}
  ],
  "size": 20,
  "from": 0,
  "highlight": {
    "fields": {
      "title": {},
      "content": {}
    }
  }
}
```

### Search Suggestions

**GET** `/api/v1/search/suggest`

Get search suggestions and auto-complete options.

**Headers**: `Authorization: Bearer <token>`

**Query Parameters**:
- `q` (string, required): Partial search term
- `limit` (integer): Number of suggestions (default: 10)

**Response**:
```json
{
  "data": {
    "suggestions": [
      "analytics",
      "analytics dashboard",
      "analytics report",
      "analytical model"
    ],
    "popular_searches": [
      "monthly reports",
      "user analytics",
      "sales dashboard"
    ]
  }
}
```

## Report Endpoints

### List Reports

**GET** `/api/v1/reports`

Retrieve a list of reports.

**Headers**: `Authorization: Bearer <token>`

**Query Parameters**:
- `limit` (integer): Results per page
- `offset` (integer): Results to skip
- `category` (string): Filter by category
- `author` (string): Filter by author
- `status` (string): Filter by status (draft, published, archived)

**Response**:
```json
{
  "data": [
    {
      "id": "rpt_123456789",
      "title": "Monthly Sales Report",
      "description": "Comprehensive sales analysis for the month",
      "category": "sales",
      "status": "published",
      "author": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "name": "John Doe",
        "email": "john.doe@example.com"
      },
      "created_at": "2024-01-10T09:00:00Z",
      "updated_at": "2024-01-12T14:30:00Z",
      "tags": ["sales", "monthly", "analytics"],
      "view_count": 145,
      "export_formats": ["pdf", "excel", "csv"]
    }
  ]
}
```

### Create Report

**POST** `/api/v1/reports`

Create a new report.

**Headers**: `Authorization: Bearer <token>`

**Request Body**:
```json
{
  "title": "Q1 Analytics Report",
  "description": "First quarter analytics and insights",
  "category": "analytics",
  "content": {
    "type": "dashboard",
    "widgets": [
      {
        "type": "chart",
        "title": "Sales Trend",
        "data_source": "ds_123456789",
        "query": "SELECT date, sales FROM monthly_sales WHERE quarter = 1"
      }
    ]
  },
  "tags": ["q1", "analytics", "quarterly"],
  "status": "draft"
}
```

**Response**:
```json
{
  "data": {
    "id": "rpt_987654321",
    "title": "Q1 Analytics Report",
    "status": "draft",
    "created_at": "2024-01-15T15:30:00Z",
    "url": "/reports/rpt_987654321"
  }
}
```

### Export Report

**POST** `/api/v1/reports/{id}/export`

Export a report in the specified format.

**Headers**: `Authorization: Bearer <token>`

**Request Body**:
```json
{
  "format": "pdf",
  "options": {
    "page_size": "A4",
    "orientation": "portrait",
    "include_data": true
  }
}
```

**Response**:
```json
{
  "data": {
    "export_id": "exp_abc123def456",
    "status": "processing",
    "estimated_completion": "2024-01-15T15:35:00Z",
    "download_url": "/api/v1/exports/exp_abc123def456/download"
  }
}
```

## File Management Endpoints

### Upload File

**POST** `/api/v1/files/upload`

Upload a file to the system.

**Headers**: 
- `Authorization: Bearer <token>`
- `Content-Type: multipart/form-data`

**Form Data**:
- `file`: The file to upload
- `name`: File name (optional)
- `category`: File category (optional)
- `description`: File description (optional)

**Response**:
```json
{
  "data": {
    "id": "file_123456789",
    "name": "sales_data.csv",
    "size": 1048576,
    "mime_type": "text/csv",
    "category": "data",
    "url": "/api/v1/files/file_123456789/download",
    "uploaded_at": "2024-01-15T15:40:00Z"
  }
}
```

### Download File

**GET** `/api/v1/files/{id}/download`

Download a file from the system.

**Headers**: `Authorization: Bearer <token>`

**Response**: Binary file content with appropriate headers

## Admin Endpoints

### System Health

**GET** `/api/v1/admin/health`

Get system health status.

**Headers**: `Authorization: Bearer <token>` (Admin required)

**Response**:
```json
{
  "data": {
    "status": "healthy",
    "services": {
      "database": {
        "status": "healthy",
        "response_time_ms": 12,
        "connections": {
          "active": 5,
          "max": 20
        }
      },
      "elasticsearch": {
        "status": "healthy",
        "response_time_ms": 8,
        "cluster_health": "green"
      },
      "redis": {
        "status": "healthy",
        "response_time_ms": 2,
        "memory_usage": "45%"
      }
    },
    "version": "1.0.0",
    "uptime_seconds": 86400
  }
}
```

### System Metrics

**GET** `/api/v1/admin/metrics`

Get system performance metrics.

**Headers**: `Authorization: Bearer <token>` (Admin required)

**Response**:
```json
{
  "data": {
    "requests": {
      "total": 10000,
      "per_minute": 167,
      "error_rate": 0.02
    },
    "cache": {
      "hit_ratio": 0.85,
      "memory_usage": "512MB",
      "keys": 1500
    },
    "database": {
      "query_avg_time": 45,
      "connections_active": 8,
      "slow_queries": 2
    }
  }
}
```

## Error Examples

### Validation Error

**Response** (422):
```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Request validation failed",
    "details": [
      {
        "field": "email",
        "message": "Invalid email format",
        "code": "INVALID_FORMAT"
      },
      {
        "field": "password",
        "message": "Password must be at least 8 characters",
        "code": "TOO_SHORT"
      }
    ]
  }
}
```

### Resource Not Found

**Response** (404):
```json
{
  "error": {
    "code": "NOT_FOUND",
    "message": "Report not found",
    "resource_type": "report",
    "resource_id": "rpt_nonexistent"
  }
}
```

### Rate Limit Exceeded

**Response** (429):
```json
{
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Rate limit exceeded",
    "limit": 1000,
    "window": 3600,
    "retry_after": 1800
  }
}
```

## Next Steps

- Explore [Authentication](../features/authentication.md) for detailed auth setup
- Learn about [Search Functionality](../features/search-functionality.md) for search implementation
- Check [API Overview](overview.md) for general API concepts
